name: Movie Monitor


on:
 schedule:
   - cron: '*/5 * * * *'
 workflow_dispatch:


jobs:
 monitor:
   runs-on: ubuntu-latest
  
   steps:
   - name: Checkout code
     uses: actions/checkout@v4
    
   - name: Set up Python
     uses: actions/setup-python@v4
     with:
       python-version: '3.11'
      
   - name: Install dependencies
     run: |
       python -m pip install --upgrade pip
       pip install -r requirements.txt
       playwright install chromium
     
   - name: Run movie monitor
     env:
       MOVIE_NAME: ${{ secrets.MOVIE_NAME }}
       SENDER_EMAIL: ${{ secrets.SENDER_EMAIL }}
       SENDER_PASSWORD: ${{ secrets.SENDER_PASSWORD }}
       RECIPIENT_EMAILS: ${{ secrets.RECIPIENT_EMAILS }}
       WEBHOOK_URL: ${{ secrets.WEBHOOK_URL }}
     run: python movie_monitor_single.py

